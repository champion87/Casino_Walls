<html>

<body onload="start()">

    <input type="range" min="0" max="100" value="0" class="slider" id="slider">
    <button id="costumize" onclick="costumize()">costumize bet</button><br><br>
    <input type="text" id="a1">
    <p id="gamble">Gamble: 0 coins</p><br><br>
    <button id="spinButton" onclick="spin_wheel_slider()">spin the wheel!</button>
    <p id="gamble_text"></p>



    <p id="bet_money_text"></p>
    <p id="prize_text"></p>
    <p id="current_coins_text"></p>


</body>
<script>
    var a1 = document.getElementById("a1")
    var slider = document.getElementById("slider")
    var output = document.getElementById("gamble");
    output.innerHTML = "Gamble " + slider.value + " coins";
    async function bet_amount() {
        coins = await get_coins();
        return Math.floor(coins / 100 * slider.value)
    }


    async function spin_wheel_slider() {
        bet = await bet_amount()
        display("gamble_text", bet)
    }


    function costumize() {
        a1.style.display = "inline"
    }

    slider.oninput = async function () {
        bet = await bet_amount()
        output.innerHTML = "Gamble " + bet + " coins";
        a1.innerHTML = bet

    }

    async function start() {
        a1.style.display = "none"
        coins = await get_coins();

        for (const n of percentage_arr) {
            display(String(n), String(n) + '% (' + Math.floor(n * coins / 100) + ' coins)')
        }
        display('coin_amount', "coin amount: " + coins + " coins")
        a1.style.display = "none"
    }


    function display(id, text) {
        document.getElementById(id).innerHTML = text
    }


    async function spin_wheel() {
        bet_percentage = document.getElementById('bet_percentage').value
        response = await fetch("/games/wheel_of_fortune/spin_wheel/" + bet_percentage);
        json = await response.json();

        prize = json.prize
        coins = json.coins
        bet_money = json.bet_money
        document.getElementById('bet_money_text').innerHTML = 'You bet ' + bet_money + " coins"
        document.getElementById('prize_text').innerHTML = 'Your prize is ' + prize + " coins"
        display('current_coins_text', 'You currently have a total of ' + coins + " coins")
        display('coin_amount', 'coin amount: ' + coins + ' coins')


        for (const n of percentage_arr) {
            display(String(n), String(n) + '% (' + Math.floor(n * coins / 100) + ' coins)')
        }


        //coin_amount = get_coins()
        //display('coin_amount', "coin amount: " + coin_amount + " coins")

    }


    async function get_coins() {
        response = await fetch("/games/wheel_of_fortune/get_coins");
        json = await response.json();
        coin_amount = json.coins
        return coin_amount
    }

</script>

</html>